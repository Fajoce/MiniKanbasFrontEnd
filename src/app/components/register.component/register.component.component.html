<div class="register-container">
  <mat-card class="register-card">
    <h2 class="title">Crear una nueva cuenta</h2>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="register-form">

      <!-- Usuario -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre de usuario</mat-label>
        <mat-icon matPrefix>person</mat-icon>
        <input matInput placeholder="Escribe tu nombre de usuario" formControlName="username" />
        <mat-error *ngIf="form.get('username')?.hasError('required')">
          Debes ingresar un nombre de usuario
        </mat-error>
        <mat-error *ngIf="form.get('username')?.hasError('minlength')">
          El nombre de usuario debe tener al menos 3 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Contraseña -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Contraseña</mat-label>
        <mat-icon matPrefix>lock</mat-icon>
        <input matInput [type]="hidePassword ? 'password' : 'text'" placeholder="Crea una contraseña segura" formControlName="password" />
        <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword" [attr.aria-label]="hidePassword ? 'Mostrar contraseña' : 'Ocultar contraseña'">
          <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        <mat-error *ngIf="form.get('password')?.hasError('required')">
          Debes ingresar una contraseña
        </mat-error>
        <mat-error *ngIf="form.get('password')?.hasError('minlength')">
          La contraseña debe tener al menos 4 caracteres
        </mat-error>
      </mat-form-field>

      <!-- Rol -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Selecciona tu rol</mat-label>
        <mat-icon matPrefix>badge</mat-icon>
        <mat-select formControlName="rol">
          <mat-option value="user">Usuario estándar</mat-option>
          <mat-option value="admin">Administrador</mat-option>
        </mat-select>
        <mat-error *ngIf="form.get('rol')?.invalid">
          Por favor selecciona un rol
        </mat-error>
      </mat-form-field>

      <!-- Mensajes -->
      <div *ngIf="errorMessage" class="error-message">
        <mat-icon>error</mat-icon> {{ errorMessage }}
      </div>
      <div *ngIf="successMessage" class="success-message">
        <mat-icon>check_circle</mat-icon> {{ successMessage }}
      </div>

      <!-- Botones -->
      <div class="button-group">
        <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">
          Crear cuenta
        </button>
        <button mat-stroked-button color="accent" type="button" (click)="goBack()">
          Volver al login
        </button>
      </div>

    </form>
  </mat-card>
</div>